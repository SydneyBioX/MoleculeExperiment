<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Count molecules per region of interest (e.g., cell) — countMolecules • MoleculeExperiment</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Count molecules per region of interest (e.g., cell) — countMolecules"><meta property="og:description" content="This function takes the information from the molecules and boundaries slot,
and counts the molecules per region of interest. Its input is a
MoleculeExperiment object, and its output a SpatialExperiment object.
That way, if one is interested in doing downstream analyses at the cell
level, one can do so."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MoleculeExperiment</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/MoleculeExperiment.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/SydneyBioX/SpatialUtils/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Count molecules per region of interest (e.g., cell)</h1>
    <small class="dont-index">Source: <a href="https://github.com/SydneyBioX/SpatialUtils/blob/HEAD/R/countMolecules.R" class="external-link"><code>R/countMolecules.R</code></a></small>
    <div class="hidden name"><code>countMolecules.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function takes the information from the molecules and boundaries slot,
and counts the molecules per region of interest. Its input is a
MoleculeExperiment object, and its output a SpatialExperiment object.
That way, if one is interested in doing downstream analyses at the cell
level, one can do so.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">countMolecules</span><span class="op">(</span></span>
<span>  <span class="va">me</span>,</span>
<span>  boundaries_assay <span class="op">=</span> <span class="st">"cell"</span>,</span>
<span>  segmentation_info <span class="op">=</span> <span class="st">"boundaries"</span>,</span>
<span>  molecules_assay <span class="op">=</span> <span class="st">"detected"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>me</dt>
<dd><p>MoleculeExperiment object containing both the transcript data as
well as the boundaries data. I.e., the "molecules" and "boundaries" slots
need to be filled. See MoleculeExperiment() for more information.</p></dd>


<dt>boundaries_assay</dt>
<dd><p>Character string naming the list of the boundaries
slot from which boundary information should be retrieved from.
For example, for counting transcripts per cell, the list containing the cell
boundaries (e.g., "cell") should be selected.</p></dd>


<dt>segmentation_info</dt>
<dd><p>Character string specifying the type of segmentation
information available. Can be either "boundaries" or "masks". Currently,
only the "boundaries" information is supported.</p></dd>


<dt>molecules_assay</dt>
<dd><p>Character string naming the list of the molecules slot
from which transcript information should be retrieved from.
The default is the detected transcript data that is read in when creating a
MoleculeExperiment object. It is possible to change it to another mode, e.g.,
"high_threshold" will access the transcript information that has been stored
in the "high_threshold" element of the list in the molecules slot.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A SpatialExperiment object derived from a MoleculeExperiment object.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">repo_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"MoleculeExperiment"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="readXenium.html">readXenium</a></span><span class="op">(</span><span class="va">repo_dir</span>,</span></span>
<span class="r-in"><span>                  n_samples <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                  keep_cols <span class="op">=</span> <span class="st">"essential"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Detected transcript information can be accessed with molecules(me) or</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> molecules(me, "detected")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Boundary information can be accessed with boundaries(me)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu">countMolecules</span><span class="op">(</span><span class="va">me</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The boundaries were retrieved from the "cell" assay. A</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> different assay (e.g., "nucleus") can be specified in the boundaries_assay</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> argument)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The transcripts from the detected assay were</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> retrieved. Other assay transcripts can be retrieved by specifying the assay_name</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> argument.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The transcripts from the detected assay were</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> retrieved. Other assay transcripts can be retrieved by specifying the assay_name</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> argument.</span>
<span class="r-in"><span><span class="va">spe</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class: SpatialExperiment </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dim: 178 14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> metadata(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assays(1): counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rownames(178): 2010300C02Rik Acsbg1 ... Trem2 Trp73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rowData names(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colnames(14): Xenium_V1_FF_Mouse_Brain_MultiSection_1_outs.67500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Xenium_V1_FF_Mouse_Brain_MultiSection_1_outs.67512 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Xenium_V1_FF_Mouse_Brain_MultiSection_2_outs.65070</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Xenium_V1_FF_Mouse_Brain_MultiSection_2_outs.65071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colData names(4): sample_id x_location y_location cell_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reducedDimNames(1): spatial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mainExpName: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> altExpNames(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spatialCoords names(2) : x_location y_location</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> imgData names(0):</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Bárbara Zita Peters Couto, Nicholas Robertson, Ellis Patrick, Shila Ghazanfar.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

